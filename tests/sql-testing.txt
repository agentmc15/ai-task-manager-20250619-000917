py -c "import pyodbc; print('Available ODBC drivers:'); [print(f'  - {driver}') for driver in pyodbc.drivers()]"

from sqlalchemy import create_engine

# Using your existing DSN
dsn = 'SQL Server C2S'
engine = create_engine(f'mssql+pyodbc://{dsn}')

# Test connection
with engine.connect() as conn:
    result = conn.execute("SELECT sap_id_rtn, Acronym FROM dimAuthorizationPackage")
    for row in result:
        print(row)


from sqlalchemy import create_engine, text
import pandas as pd

# Using your existing DSN
dsn = 'SQL Server C2S'
engine = create_engine(f'mssql+pyodbc://@{dsn}')

# Test connection
try:
    with engine.connect() as conn:
        result = conn.execute(text("SELECT @@VERSION"))
        print("Connection successful!")
        print(result.fetchone())
except Exception as e:
    print(f"Connection failed: {e}")


## test_connection1.py

import pyodbc
import pandas as pd

def fetch_data():
    dsn = 'SQL Server C2S'
    
    with pyodbc.connect(f'DSN={dsn}') as conn:
        query = "SELECT sap_id_rtn, Acronym FROM dimAuthorizationPackage"
        df = pd.read_sql(query, conn)
        return df

# Usage
df = fetch_data()
print(df)

## test_connection2.py

import pandas as pd

# Connect using DSN
dsn = 'SQL Server C2S'
conn = pyodbc.connect(f'DSN={dsn}')

# Execute query
cursor = conn.cursor()
cursor.execute("SELECT sap_id_rtn, Acronym FROM dimAuthorizationPackage")

# Fetch results
rows = cursor.fetchall()
for row in rows:
    print(row)

# Close connection
cursor.close()
conn.close()

## test_connection3.py

import pyodbc
import pandas as pd

# Connection parameters
server = 'xusrtx180dp004.device.adxrt.com'
database = 'ProofOfConceptC2S'

# Windows Authentication connection string
connection_string = (
    f'DRIVER={{ODBC Driver 17 for SQL Server}};'
    f'SERVER={server};'
    f'DATABASE={database};'
    f'Trusted_Connection=yes;'
    f'TrustServerCertificate=yes;'
)

try:
    conn = pyodbc.connect(connection_string)
    print("✓ Connection successful!")
    
    # Test query
    cursor = conn.cursor()
    cursor.execute("SELECT DB_NAME() as CurrentDatabase")
    row = cursor.fetchone()
    print(f"Connected to database: {row[0]}")
    
    conn.close()
except Exception as e:
    print(f"✗ Connection failed: {e}")
